<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Sand Simulation</title>
  <style>
    body, html {
      margin: 0;
      padding: 0;
      background-color: #222;
      height: 100%;
      overflow: hidden;
    }
    canvas {
      display: block;
      border: 1px solid black;
    }
  </style>
</head>
<body>
  <canvas id="sandbox"></canvas>
  <script>
  const canvas = document.getElementById('sandbox');
  const ctx = canvas.getContext('2d');
  let cellSize = 10;
  let grid, gridWidth, gridHeight;
  let radius = 5;
  let paused = false;
  let updateInterval = 100; // initial interval for updates
  let intervalId = null; // to store the ID of the interval

  function setupCanvas() {
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;
    gridWidth = Math.floor(canvas.width / cellSize);
    gridHeight = Math.floor(canvas.height / cellSize);
    initializeGrid();
    draw();
    startUpdateInterval();
  }

  function startUpdateInterval() {
    if (intervalId !== null) {
      clearInterval(intervalId);
    }
    intervalId = setInterval(update, updateInterval);
  }

  function initializeGrid() {
    grid = [];
    for(let i = 0; i < gridHeight; i++) {
      grid.push(new Array(gridWidth).fill(''));
    }
  }

  // The rest of your existing draw, moveCell, spawnSand, update, and handleMouseClick functions would go here.

  function handleKeyPress(event) {
    const key = event.key;
    if (key >= '1' && key <= '9') {
      currentColor = colors[key - 1];
    } else if (key === '0') {
      currentColor = 'tan';
    } else if (key === ' ') {
      grid = grid.map(row => row.map(() => ''));
      draw();
    } else if (key === 'p') {
      radius++;
      if (radius > 15) {
        radius = 15;
      }
    } else if (key === 'o') {
      radius--;
      if (radius < 1) {
        radius = 1;
      }
    } else if (key === 'e') {
      currentColor = 'erase';
    } else if (key === 'c') {
      paused = !paused;
    } else if (key === 'f') {
      if (updateInterval > 10) updateInterval -= 10; // decrease interval by 10ms
      startUpdateInterval();
    } else if (key === 's') {
      updateInterval += 10; // increase interval by 10ms
      startUpdateInterval();
    }
  }
  window.addEventListener('resize', setupCanvas);
  setupCanvas();
  canvas.addEventListener('click', handleMouseClick);
  document.addEventListener('keypress', handleKeyPress);
</script>
</body>
</html>
